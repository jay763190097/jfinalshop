<!DOCTYPE html><html lang="en">  <head>    <meta charset="utf-8">    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">    <meta content="yes" name="apple-mobile-web-app-capable">    <meta content="black" name="apple-mobile-web-app-status-bar-style">    <meta content="telephone=no,email=no" name="format-detection">    <title>商品详情</title>    <link rel="stylesheet" type="text/css" href="#(contextPath)/css/cssset.css">    <link rel="stylesheet" type="text/css" href="#(contextPath)/css/iconfont.css">    <link rel="stylesheet" type="text/css" href="#(contextPath)/css/main.css">    <style>      .title {        height: 20px;        line-height: 18px;        display: none;        padding-left: 4px;        color: #c09853;        background-color: #faeac7;        font-size: 20px;      }       dl {        line-height: 24px;        clear: both;        padding: 4px 0px;      }      dt {        width: 60px;        float: left;        margin-right: 8px;        text-align: right;        color: #888888;        white-space: nowrap;        overflow: hidden;        font-size: 20px;      }       dd {        float: left;        margin-right: 4px;        overflow: hidden;        white-space: nowrap;         line-height: 16px;      }      dd a {        min-width: 8px;        _width: 8px;        height: 20px;        line-height: 16px;        padding: 0px 8px;        display: block;        float: left;        position: relative;        outline: none;  font-size: 18px;        blr: expression(this.hideFocus = true);        border-top: 1px solid #eeeeee;        border-right: 1px solid #bbbbbb;        border-bottom: 1px solid #bbbbbb;        border-left: 1px solid #eeeeee;        background-color: #ffffff;      }       a:hover {        border-color: #ff9900;      }      dd a span {        width: 13px;        height: 18px;        display: none;        position: absolute;        right: 0px;        _right: -1px;        bottom: 0px;        _bottom: -1px;        overflow: hidden;        font-size: 12px;        background: url(#(contextPath)/img/goods.gif) -60px -540px no-repeat;      }       .selected {        border: 1px solid #f08b02;      }       .selected span {        display: block;      }       .locked {        color: #d6d6d6;        cursor: not-allowed;        border-color: #bbbbbb;        border-style: dotted;      }    </style>    <script src="#(contextPath)/js/jquery-3.1.1.min.js"></script>    <script>        var cart_key;        var productData={};        #for(x:datum.products)        productData = {            id:#(x.id),            price:#(x.price),            marketPrice:#(x.market_price),            rewardPoint:#(x.reward_point),            exchangePoint:#(x.exchange_point),            isOutOfStock:#(x.is_default)        }            // 锁定规格值            lockSpecificationValue()        #end        // 规格值选择        function change() {            if ($(this).hasClass("locked")) {                return false;            }            $(this).toggleClass("selected").parent().siblings().children("a").removeClass("selected");            lockSpecificationValue();            return false;        };        // 锁定规格值        function lockSpecificationValue() {            var currentSpecificationValueIds = $("#specificationdl").map(function() {                var selected = $(this).find("a.selected");                return  selected.length > 0 ? selected.attr("val") : [null];            }).get();            $("#specificationdl").each(function(i) {                $(this).find("a").each(function(j) {                    var specificationValueIds = currentSpecificationValueIds.slice(0);                    specificationValueIds[i] = $(this).attr("val");                    if (isValid(specificationValueIds)) {                        $(this).removeClass("locked");                    } else {                        $(this).addClass("locked");                    }                });            });            var product = productData;            if (product != null) {                productId = product.id;                $("#marketPrice").text("￥"+product.marketPrice, true);            } else {                productId = null;            }        }        // 判断规格值ID是否有效        function isValid(specificationValueIds) {            for(var key in productData) {                var ids = key.split(",");                if (specificationValueIds.indexOf(ids) >= 0) {                    return true;                }            }            return false;        }      /*  function a(){        #for(p:datum.products) #(p) #for(v:(p.specification_values))  #end #end        }*/        function addShop() {            var productId = #(datum.product.id);            var quantity = 1;            $.ajax({                type : "POST",                url : "#(contextPath)/cart/add",                data : "productId="+productId+ "&quantity="+quantity+ "&cartKey="+cart_key,                dataType : "json",                success : function(result) {                    alert(result.message);                },                error:function(msg){                    alert("服务器错误");                }                });      }        function avord() {            $("#cart").attr("href","#(contextPath)/cart/index?cartKey="+cart_key);        }        function check(){            var a = $("#show").css("display");            if(a == "none"){                $("#show").css("display","block");            }else {                $("#show").css("display","none");            }            var imageUrl = #(datum.goods.product_images);            for(var i=0;i<imageUrl.length;i++){                var obj=imageUrl[i];                var src2 = obj.large;                var url2 = "http://114.55.93.111:8080/jfinalshop-4.0-web/"+src2;                var url3 ='#(datum.goods.introduction)'                $("#coom2").attr("src",url2);                $("#coom3").append(url3);            }        }      function checkquit(){          var a = $("#specification").css("display");          if(a == "none"){              $("#specification").css("display","block");          }      }    </script>  </head>  <body>    <div class="wrap">      <div class="top-fixed">        <div class="dis-flex-between back-top">          <div goBack="back" id="back" class="back-txt"><i class="iconfont icon-arrow dis-inlineblock back-arrow"></i><span>返回</span></div><span class="host-title">商品详情</span><img src="#(contextPath)/img/share.svg" alt="" class="share-icon">        </div>      </div>      <div class="title-space"></div>      <div class="shop-con"><img src="http://114.55.93.111:8080/jfinalshop-4.0-web/#(datum.goods.image)" alt="" class="shop-detail">        <div class="shop-name">#(datum.goods.name)</div>        <div class="shop-price" id="marketPrice">¥#(datum.goods.price)<span>¥#(datum.goods.price)</span></div>      </div>      <div class="dis-flex-between specification mt20" onclick ="checkquit()"><span >选择规格</span>        <i class="iconfont icon-arrow more-arrow"></i>          <div id="specification" class="specification"  style="display: none">           #for(x:items)            <dl id="specificationdl">              <dt>                <span title="颜色">#(x.name):</span>              </dt>              #for(y:x.entries)              <dd>                #if(y.isSelected)                <a  id ="specificationa" href="javascript:;"  val=#(y.id)  onclick="change()">                  #(y.value)<span title="点击取消选择">&nbsp;</span>                </a>                #end              </dd>              #end            </dl>            #end          </div>      </div>      <div class="img-detail mt20" onclick="check()">图文详情</div>      <div class="nav-space">        <div class="productImage" id="show" style="display: none">          <a href="" id="zoom" rel="gallery">            <img class="medium" src="" id ="coom2"/>            <div class="medium" id ="coom3"></div>            <!--<div class="nav-space">宝旺专用            <div class="img-detail mt20">              <a href="#(contextPath)/index">                <img  src="#(contextPath)/img/bottom.png" class="shop-detail"/></a>            </div>-->            </div>          </a>        </div>      </div>      <ul class="nav dis-flex-between">        <li class="nav-list pl60"><a href="#(contextPath)/index">            <div class="nav-icon icon-sever"></div><span>客服</span></a></li>        <li class="nav-list"><a href="" class="icon-nav-on" id="cart"  onclick="avord()">            <div class="nav-icon icon-shoppingcart"></div><span>购物车</span></a></li>        <li class="nav-list">          <div class="add-cart" onclick="addShop()">加入购物车</div>        </li>      </ul>    </div>    <script src="#(contextPath)/js/swiper.min.js"></script>    <script src="#(contextPath)/js/common.js"></script>    <script>      // banner 滚动      var swiper = new Swiper('.swiper-container', {      	slidesPerView: 1,      	spaceBetween: 30,      	mousewheel: true,      	effect : 'fade',      	autoplay: true,      	pagination: {      		el: '.swiper-pagination',      	},      });                  (function(){      	      })();    </script>  </body></html>